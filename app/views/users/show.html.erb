<div class="row">
  <div class="col-lg-offset-3 col-lg-2 col-md-offset-2 col-md-3 col-sm-3">
    <div class="panel panel-default">
      <div class="panel-body text-center">
        <div class="row">
          <div class="col-md-12">
            <h4>
              <%= @user.name %><br>
              <small>
                @<%= @user.username %>
              </small>
            </h4>

            <% if current_user == @user %>
              <hr>
              <%= link_to 'Edit Profile', edit_user_path(@user), class: 'btn btn-link' %>
            <% else %>
              <hr>
              <% if relationship = current_user&.active_relationships.find_by(followed: @user) %>
                <%= link_to 'Unfollow', relationship_path(relationship, return_to: request.fullpath), method: :delete, class: 'btn btn-default btn-block' %>
              <% else %>
                <%= link_to 'Follow', relationships_path(return_to: request.fullpath, relationship: { followed_id: @user.id }), method: :post, class: 'btn btn-primary btn-block' %>
              <% end %>
            <% end %>
          </div>
        </div>

        <br>

        <div class="row text-center">
          <div class="col-md-6">
            <p>    
              <b>Follower</b><br>
              <%= number_with_delimiter @user.follower_count %>
            </p>
          </div>
          <div class="col-md-6">
            <p>
              <b>Following</b><br>
              <%= number_with_delimiter @user.followed_count %>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-lg-4 col-md-5 col-sm-9">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">
          Messages
        </h3>
      </div>

      <% unless @messages.present? %>
        <div class="panel-body">
          No messages yet.
        </div>
      <% end %>

      <ul class="list-group">
        <% @messages.each do |message| %>
          <li class="list-group-item">
            <div class="row">
              <div class="col-xs-12">
                <%= link_to message.content, message_path(message) %>
              </div>
            </div>

            <hr>

            <div class="row">
              <div class="col-xs-6">
                <p>
                  <% if like = message.likes.find_by(user: current_user) %>
                    <%= link_to 'Unlike', message_like_path(message, return_to: request.fullpath), method: :delete %>&nbsp;
                  <% else %>
                    <%= link_to 'Like', message_like_path(message, return_to: request.fullpath), method: :post %>&nbsp;
                  <% end %>
                  (<%= number_with_delimiter message.likes_count %>)
                </p>
              </div>
              <div class="col-xs-6 text-right">
                <p><%= time_ago_in_words message.created_at %> ago</p>
              </div>
            </div>
          </li>
        <% end %>
      </ul>
    </div>
  </div>
</div>
